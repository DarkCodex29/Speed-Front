{"version":3,"file":"hdc-autocomplete.js","sourceRoot":"","sources":["../../../../src/components/atoms/hdc-autocomplete/hdc-autocomplete.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, EventEmitter, Prop, Event, Element, h, State, Listen } from '@stencil/core';\nimport { InputType } from '@globals/enums';\nimport { getValueByPath } from '@utils';\n\n@Component({\n  tag: 'hdc-autocomplete',\n  styleUrl: 'hdc-autocomplete.scss',\n})\nexport class HdcAutocomplete {\n  /**\n   * Element of hdc multiselect\n   */\n  @Element() el: HTMLElement;\n  /**\n   * Prop type of hdc input autocomplete\n   */\n  @Prop() type: InputType = InputType.DEFAULT;\n  /**\n   * Prop value of hdc input autocomplete\n   */\n  @Prop({ mutable: true }) value: string | object | null;\n  /**\n   * Prop disable of hdc input autocomplete\n   */\n  @Prop({ mutable: true }) disable: boolean;\n  /**\n   * Prop lock of hdc input autocomplete\n   */\n  @Prop({ mutable: true }) lock: boolean;\n  /**\n   * Prop placeholder of hdc input autocomplete\n   */\n  @Prop() placeholder: string;\n  /**\n   * Prop items of hdc input autocomplete\n   */\n  @Prop({ mutable: true }) items: Array<string | object> | undefined;\n  /**\n   * Prop view items of hdc input autocomplete\n   */\n  @Prop({ mutable: true }) viewItems: number = 5;\n  /**\n   * Prop key of hdc input autocomplete\n   */\n  @Prop() valueKey = 'name';\n  /**\n   * Prop string of hdc input autocomplete\n   */\n  @Prop() valueLabel = 'name';\n  /**\n   * Event change value of hdc input autocomplete\n   */\n  @Event() selectedValue: EventEmitter<string | object | null>;\n  /**\n   * State filtered items of hdc input autocomplete\n   */\n  @State() filteredItems: Array<string | object> = [];\n  /**\n   * State search text of hdc input autocomplete\n   */\n  @State() searchText = '';\n  /**\n   * State is toggle dropdown of ibk input autocomplete\n   */\n  @State() isToggleDropdown = false;\n\n\n\n  /**\n   * State is index selected\n   */\n  @State() indexSelected = 0;\n  /**\n   * Max height of hdc input autocomplete\n   */\n  maxHeight = 26;\n  /**\n   * Determines whether change value filter options on\n   * @param event CustomEvent\n   */\n  onChangeValueFilterOptions(event: CustomEvent) {\n    this.searchText = event.detail;\n    this.indexSelected = 0;\n    if (this.searchText.length > 2) {\n      this.filteredItems =\n        this.items?.filter((option) => {\n          const label =\n            this.valueLabel && typeof option === 'object' ? option[this.valueLabel] : option;\n\n          return label.toLowerCase().includes(this.searchText.toLowerCase());\n        }) ?? [];\n      this.setToggleDropdown();\n    } else {\n      this.filteredItems = [];\n    }\n  }\n\n  /**\n   * Determines whether click select option on\n   * @param option string\n   */\n  onClickSelectOption(option: string | object) {\n    this.value = option;\n    this.filteredItems = [];\n    this.selectedValue.emit(this.value);\n  }\n  /**\n   * Determines whether clicked icon close on\n   */\n  onClickedIconClose() {\n    this.value = null;\n    this.selectedValue.emit(this.value);\n    this.indexSelected = 0;\n  }\n  /**\n   * Renders hdc input autocomplete\n   * @returns any\n   */\n  render() {\n    return (\n      <div class=\"hdc-input-autocomplete\">\n        <hdc-input\n          type={this.type}\n          placeholder={this.placeholder}\n          disable={this.disable}\n          lock={this.lock}\n          uppercase={false}\n          value={this.getValueKey()}\n          onChangeFocus={() => this.setToggleDropdown()}\n          onChangeValue={(event) => this.onChangeValueFilterOptions(event)}\n        />\n        {this.value && typeof this.value === 'object' && !this.disable &&\n          <button class=\"hdc-input-autocomplete-close\" onClick={() => this.onClickedIconClose()}>\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M6.758 17.243L12.001 12m5.243-5.243L12 12m0 0L6.758 6.757M12.001 12l5.243 5.243\" />\n            </svg>\n          </button>\n        }\n        <div class={this.getClassInputAutocompleteContainr()}>\n          <ul class={this.getClassInputAutocomplete()} style={{ maxHeight: this.getMaxHeight() }}>\n            {this.filteredItems.map((option, index) => (\n              <li\n                key={index}\n                class={this.getClassItemFilter(index)}\n                onClick={() => this.onClickSelectOption(option)}\n              >\n                {this.getStartTyping(option)}\n              </li>\n            ))}\n          </ul>\n        </div>\n      </div>\n    );\n  }\n\n  @Listen('click', { target: 'window' })\n  public handlesBodyClick(ev: Event) {\n    if (!ev.composedPath().includes(this.el)) {\n      this.isToggleDropdown = false;\n      this.indexSelected = 0;\n    }\n  }\n\n  @Listen('keydown')\n  handleKeyDown(ev: KeyboardEvent) {\n    const allowedKeys = ['ArrowDown','ArrowUp','Enter'];\n    if (allowedKeys.includes(ev.key)) {\n      let active = this.el.querySelector('li.hdc-input-autocomplete-item-active') || this.el.querySelector('ul.hdc-input-autocomplete-options li');\n      active?.classList.remove(\"hdc-input-autocomplete-item-active\");\n\n      if (ev.key === 'ArrowDown') {\n        if (this.filteredItems.length > 0 && this.indexSelected < this.filteredItems.length - 1) {\n          this.indexSelected = this.indexSelected + 1;\n        }\n        active = active?.nextElementSibling || active;\n      } else if (ev.key === 'ArrowUp') {\n        if (this.filteredItems.length > 0 && this.indexSelected > 0) {\n          this.indexSelected = this.indexSelected - 1;\n        }\n        active = active?.previousElementSibling || active;\n      } else {\n        active = ev.target as HTMLElement;\n      }\n\n      active?.classList.add('hdc-input-autocomplete-item-active');\n      const container = this.el.querySelector('ul.hdc-input-autocomplete-options');\n      const currentOffset = this.getOffset(container as Element).top + (container?.clientHeight || 0);\n      const nextElement = active?.nextElementSibling || active;\n      const nextBottom = this.getOffset(nextElement as Element).top + (nextElement?.clientHeight || 0)\n      var nextOffset = (container?.scrollTop || 0) + nextBottom - currentOffset;\n      container?.scrollTo({top: nextOffset});\n      \n      if (ev.key === 'Enter') {\n        this.onClickSelectOption(this.filteredItems[this.indexSelected]);\n      }\n    }\n  }\n\n\n  setToggleDropdown() {\n    this.isToggleDropdown = this.filteredItems.length > 0;\n  }\n\n  /**\n   * Gets start typing\n   * @param value string | object\n   * @returns any\n   */\n  getStartTyping(value: string | object) {\n    const label = this.valueLabel && typeof value === 'object' ? value[this.valueLabel] : value;\n\n    return label;\n  }\n  getStyleKeyboard(index: number) {\n    return {\n      'hdc-input-autocomplete-item': true,\n      'hdc-input-autocomplete-item-active': index == this.indexSelected,\n    };\n  }\n  /**\n   * Gets max height\n   * @returns { [key: string]: boolean }\n   */\n  getMaxHeight() {\n    return this.viewItems > 0 ? `${this.maxHeight * this.viewItems}px` : '';\n  }\n\n  /**\n   * Gets class input autocomplete containr\n   * @returns { [key: string]: boolean }\n   */\n  getClassInputAutocompleteContainr() {\n    return {\n      'hdc-input-autocomplete-container': true,\n      'hdc-input-autocomplete-container--top': false,\n      'hdc-input-autocomplete-container--show': this.filteredItems.length > 0\n    };\n  }\n\n  /**\n   * Gets class input autocomplete\n   * @returns { [key: string]: boolean }\n   */\n  getClassInputAutocomplete() {\n    return {\n      'hdc-input-autocomplete-options': true,\n    };\n  }\n\n  getClassItemFilter(index: number) {\n    return {\n      'hdc-input-autocomplete-item': true,\n      'hdc-input-autocomplete-item-active': index === 0,\n    }\n  }\n\n  /**\n   * Gets value key\n   * @returns string\n   */\n  getValueKey() {\n    return (\n      this.valueKey && this.value && typeof this.value === 'object'\n        ? getValueByPath(this.value, this.valueLabel.split('.'))\n        : this.value\n    ) as string;\n  }\n\n  private getOffset(element: Element) {\n    if (!element.getClientRects().length)\n    {\n      return { top: 0, left: 0 };\n    }\n\n    let rect = element.getBoundingClientRect();\n    let win = element.ownerDocument.defaultView;\n    return (\n    {\n      top: rect.top + (win?.scrollY || 0),\n      left: rect.left + (win?.scrollX || 0),\n    });  \n  }\n}"]}